# Generated by Ollama Llama 3
# Task: inside_op_xmr_scenarios_rich
# Attempt: 5
# Success: False
# Overall Score: 0.458

from pyverilog.ast import *
import re


def find_inside_reference(node, signal_name):
    if isinstance(node, Node) and node.children():
        for child in node.children():
            if (isinstance(child, Assign)):
                lhs = child.lhs
                rhs = child.rhs

                # Check if the reference is inside an assign statement
                if ((lhs and isinstance(lhs, Reference)) or
                    (rhs and isinstance(rhs, Reference))):
                        if lhs and lhs.name == signal_name:
                            return True
                        elif rhs and rhs.name == signal_name:
                            return True
            result = find_inside_reference(child, signal_name)
            if result is not None:
                return result
    return None


def inside_operator_transform(input_file, output_file, signal_name):
    ast, directives = parse([input_file])
    
    # Apply visitor
    visitor = ExampleVisitor(signal_name)
    for node in ast.children():
        if isinstance(node, Node) and node.children():
            result = find_inside_reference(node, signal_name)
            if result is not None:
                print("Found reference inside an assign statement")
            
    with open(input_file, "r") as f:
        content = f.read()
    
    # Apply changes...
    modified_content = re.sub(r'\b'+signal_name+r'\s*\=\s*.*;', '', content)
    
    # Write output
    with open(output_file, "w") as f:
        f.write(modified_content)
        
    return True